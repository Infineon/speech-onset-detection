<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Audio speech onset detection library: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Audio speech onset detection library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Overview </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The purpose of a speech onset detector (SOD) is to detect the beginning of a spoken word or utterance. For the target application, the SOD is the first stage of a low power multi-stage wake-up phrase solution. The device is placed in a very low power stand-by mode, but may be woken by the utterance of wake-up phrase. Because the utterance may be spoken at any time, the system is considered "Always On" and may consume significant power. To reduce the power, a multi-stage approach is utilized. In the 1st stage, an always-on low-power SOD is used to detect the onset of speech. If detected, further processing is brought to active state to execute the wake-up phrase detection (WUPD) algorithm. If the WUPD rejects the activity, the WUPD and the processor are placed back in hibernation, and control is passed back to the SOD.</p>
<p ><img src="sod_diagram.png" alt="" width="900cm" height="280cm" class="inline" title="Audio front end"/></p>
<p >As shown in the block diagram, audio data from the user or environmental noise is fed to the SOD algorithm and the algorithm processes audio data and checks if speech onset is detected. If speech onset is detected, then the audio data is fed to the wake word detection algorithm for further processing.</p>
<p >Speech onset detection middleware provides APIs to feed the audio data and get the status on whether the speech onset was detected or not.</p>
<h1><a class="anchor" id="section_features"></a>
Features and functionality</h1>
<p >The current implementation has the following features and functionality:</p><ul>
<li>SOD MW Input format: SOD MW accepts the audio data in PCM format at 16Khz worth of 10ms for every cy_sod_feed().</li>
<li>SOD MW configurable options are:<ul>
<li>OnsetGap</li>
<li>Sensitivity</li>
</ul>
</li>
<li><b>OnsetGap</b>: Generally, a talker will pause momentarily before addressing a person or in this case, a device. The pause is approximately in the range of 200-500 ms in conversational speech. This compares with the time between words in conversation speech of 0-100ms. If the application is attempting to detect a wake-word, then a pause of at least 200ms is likely. Detecting a keyword in conversational speech would require essentially no pause at all; therefore, it needs full time monitoring; thus unlikely to use an SOD. For the wake-word detection application, having a pause has the advantage of disengaging the wake-word detection during conversational speech and relying on the low complexity SOD to detect an appropriate pause.</li>
<li><b>Sensitivity</b>: The performance of the SOD can be characterized by its detection rate and false positive rate. Their relationship is captured in the receiver operating characteristic curve (ROC) and studied. A depiction of the ROC depicts that, as the SNR decreases (increasing noise relative to the speech signal), the false positive rate increases for a given detection rate. In order to control the operating point of the SOD, and hence the trade-off between detection rate and false positive rate is defined as sensitivity. The sensitivity is controlled by modifying the thresholds for detection.</li>
</ul>
<h1><a class="anchor" id="section_prerequisite"></a>
Prerequisite</h1>
<p >Please refer to <b>README.md</b> for quick start on platforms</p>
<h1><a class="anchor" id="section_code_snippet"></a>
Code snippets</h1>
<h2><a class="anchor" id="snip1"></a>
Code Snippet 1: Initialize SOD middleware</h2>
<p >This code snippet demonstrates how to initialize speech onset detection middleware with configuration </p><div class="fragment"><div class="line"><span class="preprocessor">#define SOD_SENSITIVITY  (16384)</span></div>
<div class="line">cy_rslt_t snippet_sod_init(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    cy_rslt_t ret_val = CY_RSLT_SUCCESS;</div>
<div class="line">    <a class="code hl_struct" href="structcy__sod__config__params.html">cy_sod_config_params</a> sod_config_params = {0};</div>
<div class="line">    <span class="keywordtype">void</span> *app_sod_handle = NULL;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;sod_config_params, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structcy__sod__config__params.html">cy_sod_config_params</a>));</div>
<div class="line"> </div>
<div class="line">    sod_config_params.<a class="code hl_variable" href="structcy__sod__config__params.html#ab91a98fcc3f8f836a99223ea36ddc7ab">sensitivity</a> = SOD_SENSITIVITY;</div>
<div class="line">    sod_config_params.<a class="code hl_variable" href="structcy__sod__config__params.html#a74897f0c20ebf170e33f9fc9233e9191">onset_gap_setting_ms</a> = <a class="code hl_define" href="group__group__sod__macros.html#ga166a13427a6dbb3801afa3fd8f238864">CY_SOD_ONSET_GAP_SETTING_400_MS</a>;</div>
<div class="line"> </div>
<div class="line">    ret_val = <a class="code hl_function" href="group__group__sod__functions.html#ga0afd05b75e6221919d1ba78adf490625">cy_sod_init</a>(&amp;sod_config_params, &amp;app_sod_handle);</div>
<div class="line">    <span class="keywordflow">if</span>(ret_val != CY_RSLT_SUCCESS)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Failed to initialize SOD component \r\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;SOD init success \r\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret_val;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__sod__functions_html_ga0afd05b75e6221919d1ba78adf490625"><div class="ttname"><a href="group__group__sod__functions.html#ga0afd05b75e6221919d1ba78adf490625">cy_sod_init</a></div><div class="ttdeci">cy_rslt_t cy_sod_init(cy_sod_config_params *config_params, cy_sod_t *handle)</div><div class="ttdoc">Initializes the SOD MW.</div></div>
<div class="ttc" id="agroup__group__sod__macros_html_ga166a13427a6dbb3801afa3fd8f238864"><div class="ttname"><a href="group__group__sod__macros.html#ga166a13427a6dbb3801afa3fd8f238864">CY_SOD_ONSET_GAP_SETTING_400_MS</a></div><div class="ttdeci">#define CY_SOD_ONSET_GAP_SETTING_400_MS</div><div class="ttdoc">Speech onset gap of 400ms.</div><div class="ttdef"><b>Definition:</b> cy_sod.h:66</div></div>
<div class="ttc" id="astructcy__sod__config__params_html"><div class="ttname"><a href="structcy__sod__config__params.html">cy_sod_config_params</a></div><div class="ttdoc">SOD configuration parameters.</div><div class="ttdef"><b>Definition:</b> cy_sod.h:150</div></div>
<div class="ttc" id="astructcy__sod__config__params_html_a74897f0c20ebf170e33f9fc9233e9191"><div class="ttname"><a href="structcy__sod__config__params.html#a74897f0c20ebf170e33f9fc9233e9191">cy_sod_config_params::onset_gap_setting_ms</a></div><div class="ttdeci">int onset_gap_setting_ms</div><div class="ttdoc">Onset gap settings.</div><div class="ttdef"><b>Definition:</b> cy_sod.h:176</div></div>
<div class="ttc" id="astructcy__sod__config__params_html_ab91a98fcc3f8f836a99223ea36ddc7ab"><div class="ttname"><a href="structcy__sod__config__params.html#ab91a98fcc3f8f836a99223ea36ddc7ab">cy_sod_config_params::sensitivity</a></div><div class="ttdeci">int sensitivity</div><div class="ttdoc">Sensitivity, The detection sensitivity (0- 32767) 0 = least sensitive 32767 (MAX_SOD_SENSITIVITY) = m...</div><div class="ttdef"><b>Definition:</b> cy_sod.h:157</div></div>
</div><!-- fragment --><h2><a class="anchor" id="snip2"></a>
Code Snippet 2: SOD initialization &amp; audio processing</h2>
<p >This code snippet demonstrates how to initialize SOD middleware and feed audio data </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_sod_process()</div>
<div class="line">{</div>
<div class="line">    cy_rslt_t ret_val = CY_RSLT_SUCCESS;</div>
<div class="line">    <a class="code hl_struct" href="structcy__sod__config__params.html">cy_sod_config_params</a> sod_config_params = {0};</div>
<div class="line">    <span class="keywordtype">void</span> *sod_handle = NULL;</div>
<div class="line">    <a class="code hl_enumeration" href="group__group__sod__enums.html#ga9745b238aa30c6833610e8b597d05f62">cy_sod_status_t</a> sod_status = <a class="code hl_enumvalue" href="group__group__sod__enums.html#gga9745b238aa30c6833610e8b597d05f62a2d76333457d29ebc7de5834ef248754a">CY_SOD_STATUS_INVALID</a>;</div>
<div class="line">    int16_t* input_audio = NULL;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;sod_config_params, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structcy__sod__config__params.html">cy_sod_config_params</a>));</div>
<div class="line"> </div>
<div class="line">    sod_config_params.<a class="code hl_variable" href="structcy__sod__config__params.html#ab91a98fcc3f8f836a99223ea36ddc7ab">sensitivity</a> = SOD_SENSITIVITY;</div>
<div class="line">    sod_config_params.<a class="code hl_variable" href="structcy__sod__config__params.html#a74897f0c20ebf170e33f9fc9233e9191">onset_gap_setting_ms</a> = <a class="code hl_define" href="group__group__sod__macros.html#ga166a13427a6dbb3801afa3fd8f238864">CY_SOD_ONSET_GAP_SETTING_400_MS</a>;</div>
<div class="line"> </div>
<div class="line">    ret_val = <a class="code hl_function" href="group__group__sod__functions.html#ga0afd05b75e6221919d1ba78adf490625">cy_sod_init</a>(&amp;sod_config_params, &amp;sod_handle);</div>
<div class="line">    <span class="keywordflow">if</span>(ret_val != CY_RSLT_SUCCESS)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Failed to initialize SOD component \r\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;SOD init success \r\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Receive data from PDM microphone */</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__group__sod__functions.html#ga229dca827a628ecc3810bad5cfbc3f66">cy_sod_process</a>(sod_handle, <span class="keyword">true</span>, (int16_t *)input_audio, &amp;sod_status);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="group__group__sod__enums.html#gga9745b238aa30c6833610e8b597d05f62a5ccb72e2b6be784483bf8d5b8435ad79">CY_SOD_STATUS_DETECTED</a> == sod_status)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;SOD detected \r\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__sod__enums_html_ga9745b238aa30c6833610e8b597d05f62"><div class="ttname"><a href="group__group__sod__enums.html#ga9745b238aa30c6833610e8b597d05f62">cy_sod_status_t</a></div><div class="ttdeci">cy_sod_status_t</div><div class="ttdoc">SOD detection status.</div><div class="ttdef"><b>Definition:</b> cy_sod.h:102</div></div>
<div class="ttc" id="agroup__group__sod__enums_html_gga9745b238aa30c6833610e8b597d05f62a2d76333457d29ebc7de5834ef248754a"><div class="ttname"><a href="group__group__sod__enums.html#gga9745b238aa30c6833610e8b597d05f62a2d76333457d29ebc7de5834ef248754a">CY_SOD_STATUS_INVALID</a></div><div class="ttdeci">@ CY_SOD_STATUS_INVALID</div><div class="ttdoc">Speech detection status is invalid.</div><div class="ttdef"><b>Definition:</b> cy_sod.h:106</div></div>
<div class="ttc" id="agroup__group__sod__enums_html_gga9745b238aa30c6833610e8b597d05f62a5ccb72e2b6be784483bf8d5b8435ad79"><div class="ttname"><a href="group__group__sod__enums.html#gga9745b238aa30c6833610e8b597d05f62a5ccb72e2b6be784483bf8d5b8435ad79">CY_SOD_STATUS_DETECTED</a></div><div class="ttdeci">@ CY_SOD_STATUS_DETECTED</div><div class="ttdoc">Speech onset is detected.</div><div class="ttdef"><b>Definition:</b> cy_sod.h:113</div></div>
<div class="ttc" id="agroup__group__sod__functions_html_ga229dca827a628ecc3810bad5cfbc3f66"><div class="ttname"><a href="group__group__sod__functions.html#ga229dca827a628ecc3810bad5cfbc3f66">cy_sod_process</a></div><div class="ttdeci">cy_rslt_t cy_sod_process(cy_sod_t handle, bool sod_check_trigger, int16_t *data, cy_sod_status_t *sod_status)</div><div class="ttdoc">Process the audio data and detect the speech onset on the data.</div></div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>Audio speech onset detection library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
</body>
</html>
